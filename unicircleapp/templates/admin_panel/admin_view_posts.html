{% extends "admin_panel/admin_panel_base.html" %}
{% block title %}All Students{% endblock %}
{% block content %}

{% load static %}
  <link rel="stylesheet" href="{% static 'posts_area.css' %}" />

<div class="container my-5">
        <h2 class="mb-4 text-orangered">Posts</h2>
        <div class="posts-area">
          {% for post in posts %}
          <div class="post-main" data-post-id="{{ post.id }}">
            <div class="post-header">
              <div class="profile">
                <img src="{% if post.author.profile.profile_picture and post.author.profile.profile_picture.name %}
                  {{ post.author.profile.profile_picture.url }}
                {% else %}
                  {% static 'images/default_avatar.jpg' %}
                {% endif %}" alt="Profile Picture" />
                <div class="user-details">
                  <div class="user-name">{{ post.author.username }}</div>
                  <div class="user-type">{{ post.author.user_type }}</div>
                  <p class="post-date">{{ post.created_at|timesince }} ago</p>
                </div>
              </div>
              <div class="options">
                  <form action="{% url 'post:admin_delete_post' post.id %}" method="post" class="delete-post-form">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                  </form>
                
              </div>
            </div>

            <div class="post-description">{{ post.content }}</div>

            {% if post.image %}
            <div class="post-image-container">
              <img class="post-image" src="{{ post.image.url }}" alt="Post Image" />
            </div>
            {% endif %}

            <!-- Interaction section -->
            <div class="post-interaction">
            
                <!-- Disabled Like -->
                <button type="button" class="btn btn-like" disabled>
                  <i class="fa-regular fa-heart"></i> Like ({{ post.likes.count }})
                </button>
            
              <!-- Comments Section -->
              <h5 class="mt-3">Comments</h5>
              <div class="comments-list">
                {% for comment in post.comments.all %}
                <div class="comment-item" data-comment-id="{{ comment.id }}">
                  <b>{{ comment.author.username }}</b> {{ comment.content }}
                 
                    <form action="{% url 'post:delete_comment' comment.id %}" method="post"
                      class="delete-comment-form d-inline">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-link text-danger btn-sm" >
                        <span style="color: white;">Delete</span>
                      </button>
                    </form>
                 
                </div>
                {% empty %}
                <p class="text-muted">No comments yet.</p>
                {% endfor %}
              </div>
            </div>
          </div>
          {% empty %}
          <p class="text-muted">No posts yet.</p>
          {% endfor %}
        </div>
      </div>

{% endblock %}